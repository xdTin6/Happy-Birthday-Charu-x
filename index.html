<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Happy Birthday, My Love ‚ù§Ô∏è</title>
  <meta name="theme-color" content="#ff4d6d" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    /* ===================
       GLOBAL / THEME
       =================== */
    :root{
      --pink:#ff4d6d;     /* primary accent */
      --rose:#ff8fab;     /* secondary accent */
      --crimson:#ff0a54;  /* strong punch */
      --bg:#0b070a;       /* deep base */
      --ink:#11070d;      /* section base */
      --glass: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.28);
      --text: rgba(255,255,255,.95);
      --muted: rgba(255,255,255,.72);
      --shadow-xl: 0 18px 60px rgba(0,0,0,.55), 0 4px 16px rgba(0,0,0,.35):
      --radius-xl: 26px;
    }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0; background:var(--bg); color:var(--text); font-family:"Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; overflow-x:hidden;
    }
    a{ color:inherit; text-decoration:none }

    /* ===================
       NAVBAR
       =================== */
    .nav{
      position:fixed; inset:16px 16px auto 16px; display:flex; align-items:center; justify-content:space-between; padding:10px 14px; z-index:50;
      background:var(--glass); border:1px solid var(--stroke); backdrop-filter: blur(14px) saturate(140%); -webkit-backdrop-filter: blur(14px) saturate(140%);
      border-radius:16px; box-shadow: var(--shadow-xl);
    }
    .brand{ display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.02em }
    .brand .sig{ font-family:"Great Vibes", cursive; font-size:24px; color:var(--rose); }
    .nav a{ opacity:.85; padding:6px 10px; border-radius:10px; font-weight:600 }
    .nav a:hover, .nav a.active{ background:rgba(255,255,255,.08); opacity:1 }

    /* ===================
       HERO (3D + PARALLAX)
       =================== */
    header.hero{
      position:relative; min-height:100svh; display:grid; place-items:center; text-align:center; overflow:hidden;
    }
    /* blurred animated gradient backdrop */
    .bg-blur{ position:absolute; inset:-20vmax; z-index:-3; filter: blur(120px) saturate(120%); opacity:.9; animation: drift 22s ease-in-out infinite alternate; }
    .bg-blur::before, .bg-blur::after{ content:""; position:absolute; inset:0; background:
      radial-gradient(60vmax 40vmax at 15% 20%, rgba(255,77,109,.7), transparent 60%),
      radial-gradient(70vmax 50vmax at 80% 25%, rgba(255,143,171,.6), transparent 55%),
      radial-gradient(60vmax 50vmax at 50% 80%, rgba(255,10,84,.5), transparent 60%);
      mix-blend-mode: screen;
    }
    .bg-noise{ position:absolute; inset:-10vmax; z-index:-2; pointer-events:none; opacity:.12; mix-blend-mode:overlay }
    .bg-noise svg{ width:140vw; height:140vh }
    @keyframes drift{ from{ transform:translate3d(0,0,0) scale(1.05)} to{ transform:translate3d(4%, -3%, 0) scale(1.12)} }

    .hero-inner{ position:relative; z-index:2; padding: 18svh 16px 14svh; max-width: 1000px; }
    .eyebrow{ display:inline-flex; gap:.5rem; align-items:center; padding:.5rem 1rem; border-radius:999px; background:rgba(255,255,255,.1); border:1px solid var(--stroke); backdrop-filter: blur(6px); font-weight:800; letter-spacing:.08em; text-transform:uppercase; color:var(--muted) }
    .title{ font-family:"Great Vibes", cursive; font-size: clamp(56px, 12vw, 132px); line-height:1; margin:14px 0 6px; background:linear-gradient(45deg, #fff, #ffd6e0, var(--pink)); -webkit-background-clip:text; background-clip:text; color:transparent; animation: titleShift 8s ease-in-out infinite alternate; }
    @keyframes titleShift{ 0%{ filter:drop-shadow(0 10px 30px rgba(255,0,80,.2)) } 100%{ filter:drop-shadow(0 16px 50px rgba(255,0,80,.45)) } }
    .subtitle{ font-size:clamp(18px, 2.6vw, 24px); color:var(--muted); max-width: 70ch; margin-inline:auto }

    /* CTA buttons */
    .cta{ display:flex; justify-content:center; gap:12px; flex-wrap:wrap; margin-top:22px }
    .btn{ appearance:none; border:none; cursor:pointer; font-weight:800; padding:14px 20px; border-radius:16px; box-shadow: var(--shadow-xl); letter-spacing:.02em; transition: transform .12s ease, background .3s ease, color .3s ease; position:relative }
    .btn.primary{ background:linear-gradient(135deg, var(--crimson), var(--pink)); color:white }
    .btn.ghost{ background:var(--glass); border:1px solid var(--stroke); color:var(--text); backdrop-filter: blur(8px) }
    .btn:hover{ transform: translateY(-2px) }

    /* 3D canvas (Three.js) */
    #scene3d{ position:absolute; inset:0; z-index:1; pointer-events:none }

    /* ===================
       SECTIONS
       =================== */
    main{ position:relative; z-index:3 }
    section{ padding: min(8svh, 80px) 16px; }
    .container{ width:min(1200px, 92vw); margin-inline:auto }

    .card{
      background:var(--glass); border:1px solid var(--stroke); border-radius:var(--radius-xl); box-shadow:var(--shadow-xl); backdrop-filter: blur(16px) saturate(150%); -webkit-backdrop-filter: blur(16px) saturate(150%);
    }

    /* Message */
    .message{ text-align:center; padding: clamp(22px, 4vw, 42px) }
    .message h2{ font-family:"Great Vibes", cursive; font-size: clamp(36px, 6vw, 64px); color:var(--rose); margin:0 0 10px }
    .message p{ font-size:clamp(16px, 2.2vw, 20px); line-height:1.8 }

    /* Gallery */
    .gallery{ display:grid; gap:14px; grid-template-columns: repeat(12, 1fr); padding: 14px }
    .ph{ position:relative; overflow:hidden; border-radius:20px; grid-column: span 4; aspect-ratio: 3 / 4; transform-style:preserve-3d; transition: transform .2s ease; }
    .ph.wide{ grid-column: span 8; aspect-ratio: 16 / 9 }
    .ph.tall{ grid-column: span 4; aspect-ratio: 4 / 5 }
    .ph img{ width:100%; height:100%; object-fit:cover; filter:saturate(1.06) contrast(1.05); transform: translateZ(0); transition: transform .6s ease }
    .ph:hover img{ transform:scale(1.06) }

    /* Video */
    .videoWrap{ display:grid; grid-template-columns: 1.1fr .9fr; gap:20px; align-items:center; padding: 16px }
    .vframe{ border-radius:20px; overflow:hidden; box-shadow: var(--shadow-xl) }
    .vframe video{ display:block; width:100%; height:auto; background:black }
    .vtext h3{ font-size: clamp(22px, 4vw, 36px) }
    .vtext p{ color:var(--muted) }

    /* Music + Visualizer */
    .player{ display:grid; grid-template-columns: auto 1fr auto; gap:12px; align-items:center; padding: 18px }
    .track{ font-weight:800 }
    .controls{ display:flex; gap:10px }
    .btn.sm{ padding:10px 14px; border-radius:12px }
    .scrub{ appearance:none; width:100%; height:8px; background:rgba(255,255,255,.15); border-radius:999px; outline:none }
    .scrub::-webkit-slider-thumb{ -webkit-appearance:none; appearance:none; width:16px; height:16px; border-radius:50%; background:linear-gradient(135deg, var(--crimson), var(--pink)); box-shadow:0 2px 6px rgba(0,0,0,.28) }
    canvas#viz{ width:100%; height:90px; display:block }

    /* Timeline (mini portfolio of memories) */
    .timeline{ position:relative; padding:24px }
    .timeline::before{ content:""; position:absolute; left:calc(50% - 2px); top:0; bottom:0; width:4px; background:linear-gradient(var(--rose), transparent); filter:blur(.4px) }
    .trow{ display:grid; grid-template-columns: 1fr 1fr; gap:20px; margin: 28px 0; align-items:center }
    .trow:nth-child(even) .tcard{ order:2 }
    .tcard{ padding:18px; border-radius:18px; background:var(--glass); border:1px solid var(--stroke) }
    .timg{ border-radius:16px; overflow:hidden; box-shadow: var(--shadow-xl) }
    .timg img{ width:100%; height:auto; display:block }

    /* Footer */
    footer{ text-align:center; padding: 50px 16px; color:var(--muted) }

    /* Responsive */
    @media (max-width: 900px){
      .ph{ grid-column: span 6 }
      .ph.wide{ grid-column: span 12 }
      .videoWrap{ grid-template-columns: 1fr }
      .timeline::before{ left:10px }
      .trow{ grid-template-columns: 1fr; padding-left:24px }
    }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      .bg-blur{ animation:none }
      .title{ animation:none }
    }
  </style>
</head>
<body>
  <!-- NAV -->
  <nav class="nav">
    <div class="brand"><span class="sig">For You</span> <span>‚Ä¢</span> <strong>Birthday 2025</strong></div>
    <div class="links">
      <a href="#home" class="active">Home</a>
      <a href="#message">Message</a>
      <a href="#gallery">Photos</a>
      <a href="#video">Video</a>
      <a href="#music">Song</a>
      <a href="#timeline">Memories</a>
    </div>
  </nav>

  <!-- HERO -->
  <header id="home" class="hero">
    <div class="bg-blur"></div>
    <div class="bg-noise" aria-hidden="true">
      <svg viewBox="0 0 100 100" preserveAspectRatio="none">
        <filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2"/><feColorMatrix type="saturate" values="0"/></filter>
        <rect width="100" height="100" filter="url(#n)"></rect>
      </svg>
    </div>
    <canvas id="scene3d"></canvas>
    <div class="hero-inner container">
      <span class="eyebrow">Happy Birthday ‚Ä¢ With Love</span>
      <h1 class="title">To My Forever Person</h1>
      <p class="subtitle">An immersive little universe of us ‚Äî photos, film, and a song I made for you. Scroll down and let the magic (and the music) begin. üíñ</p>
      <div class="cta">
        <button class="btn primary" id="playSong">Play Our Song</button>
        <a class="btn ghost" href="#gallery">See Photos</a>
      </div>
    </div>
  </header>

  <main>
    <!-- MESSAGE -->
    <section id="message">
      <div class="container card message">
        <h2>A Note From Me ‚ù§Ô∏è</h2>
        <p>
          Happy Birthday Charu üíó You make ordinary days feel cinematic. Thank you for your kindness, your laughter, and your endless patience with my bad jokes. I‚Äôm so proud of who you are and everything you‚Äôre becoming ‚Äî and I‚Äôm honored to be right beside you for every frame of it. I Love You My Women üíó
        </p>
      </div>
    </section>

    <!-- GALLERY -->
    <section id="gallery">
      <div class="container card">
        <div class="gallery" id="galleryGrid">
          <!-- Replace with your images under ./assets/photos/ -->
          <figure class="ph wide"><img src="Content/Screenshot 2025-08-24 at 6.31.26 PM.png" alt="Beautiful Pookie"></figure>
          <figure class="ph"><img src="Content/564A2C36-4CE0-4808-ABDE-765B80637323.JPG" alt="Wifuü•∞"></figure>
          <figure class="ph tall"><img src="Content/hieee.JPG" alt="Charuüíó"></figure>
          <figure class="ph"><img src="Content/Screenshot 2025-08-24 at 6.51.51 PM.png" alt="Cutieüò≠"></figure>
          <figure class="ph"><img src="Content/Screenshot 2025-08-24 at 6.54.09 PM.png" alt="Pooookuüò≥"></figure>
          <figure class="ph wide"><img src="Content/KIKO.JPG" alt="Hieeeeeü•∞"></figure>
        </div>
      </div>
    </section>

    <!-- VIDEO -->
    <section id="video">
      <div class="container card">
        <div class="videoWrap">
          <div class="vframe">
            <video controls playsinline poster="Content/Unknown.jpg">
              <source src="Content/BF9E5E4C-BF62-4980-8F39-AED0F76321CD.mp4" type="video/mp4" />
            </video>
          </div>
          <div class="vtext">
            <h3>Hit play for a surprise ‚ú®</h3>
            <p>A mini film of us ‚Äî the goofy, the gorgeous, and everything in between. (Headphones recommended!)</p>
          </div>
        </div>
      </div>
    </section>

    <!-- MUSIC + VISUALIZER -->
    <section id="music">
      <div class="container card">
        <div class="player">
          <div class="track">Meri Banogi Kya ?</div>
          <input id="seek" class="scrub" type="range" min="0" max="100" value="0" aria-label="Seek" />
          <div class="time"><span id="cur">0:00</span> / <span id="dur">0:00</span></div>
          <div class="controls" style="grid-column:1 / -1; justify-self:center;">
            <button class="btn sm ghost" id="back10">‚ü≤ 10s</button>
            <button class="btn sm primary" id="toggle">Play ‚èµ</button>
            <button class="btn sm ghost" id="fwd10">10s ‚ü≥</button>
          </div>
          <canvas id="viz"></canvas>
        </div>
        <audio id="audio" preload="metadata">
          <!-- Replace with your GitHub raw file URL or path, e.g., assets/song.mp3 -->
          <source src="Content/Meri Banogi Kya - Rito Riba  Prakriti P  Karan J  Rajat Nagpal  Anshul Garg  Gurinder Bawa.mp3" type="audio/mpeg" />
        </audio>
      </div>
    </section>

    <!-- TIMELINE / MEMORIES -->
    <section id="timeline">
      <div class="container card">
        <div class="timeline">
          <div class="trow">
            <div class="timg"><img src="Content/IMG_2660.PNG" alt="First photo together"></div>
            <div class="tcard"><h4>How It Started</h4><p class="muted">The first time you smiled at me, the room went brighter than the sun. I knew. Tere Naino Se Jo Mere Nain Takare Toh Meri Jindgi Me Sitare Se Khil Jaye Tere Pyaar Me Doobta Jara Hu Pagli Ab Tere Se Durr Na Raha Jaye üò≠</p></div>
          </div>
          <div class="trow">
            <div class="timg"><img src="Content/IMG_2659.PNG" alt="Travel memory"></div>
            <div class="tcard"><h4>Our Adventures</h4><p class="muted">Maps, midnight snacks, and getting a little lost ‚Äî my favorite kind of found. Hehe I Loved When You Posted This Collage of Us ‚ú® </p></div>
          </div>
          <div class="trow">
            <div class="timg"><img src="Content/A7BFBA70-E4A6-4EA6-869B-D015E55226E8.JPG" alt="Cozy day"></div>
            <div class="tcard"><h4>Quiet Days</h4><p class="muted">Coffee, music, and your sweater. I could live in these moments forever. Teri Muskurat Jo Mere Mann Ko Aaram Deti hai I Can't Explain That I Really Felt Better When I Saw U While I Was Sick ü•∞‚ú®</p></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>Made with ‚ù§Ô∏è by Ur Bacchu</footer>

  <!-- LIBS: Three.js + GSAP (for parallax/entrances) -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.156.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>

  <script>
    // ===================
    // NAV Active Link on Scroll
    // ===================
    const navLinks = document.querySelectorAll('.nav a');
    const sections = [...navLinks].map(a => document.querySelector(a.getAttribute('href')));
    const onScroll = () => {
      const pos = window.scrollY + 120;
      sections.forEach((sec, i)=>{
        if (!sec) return;
        const top = sec.offsetTop, bottom = top + sec.offsetHeight;
        if (pos >= top && pos < bottom){ navLinks.forEach(l=>l.classList.remove('active')); navLinks[i].classList.add('active'); }
      });
    };
    document.addEventListener('scroll', onScroll);
    window.addEventListener('load', onScroll);

    // ===================
    // THREE.JS ‚Äî GLOWING 3D HEART + PARTICLES
    // ===================
    const canvas3d = document.getElementById('scene3d');
    const renderer = new THREE.WebGLRenderer({ canvas: canvas3d, antialias:true, alpha:true });
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.setSize(window.innerWidth, window.innerHeight);

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(55, window.innerWidth/window.innerHeight, 0.1, 100);
    camera.position.z = 7;

    // lights
    const aLight = new THREE.AmbientLight(0xff6f91, .7); scene.add(aLight);
    const pLight = new THREE.PointLight(0xff4d6d, 1.2, 50); pLight.position.set(6,6,6); scene.add(pLight);

    // heart shape (extruded)
    const heartShape = new THREE.Shape();
    heartShape.moveTo(0,0);
    heartShape.bezierCurveTo(0,2, -2,2, -2,0);
    heartShape.bezierCurveTo(-2,-2, 0,-3, 0,-4);
    heartShape.bezierCurveTo(0,-3, 2,-2, 2,0);
    heartShape.bezierCurveTo(2,2, 0,2, 0,0);

    const extrude = new THREE.ExtrudeGeometry(heartShape, { depth: 1.2, bevelEnabled:true, bevelThickness:.35, bevelSize:.35, bevelSegments:12 });
    extrude.center();
    const mat = new THREE.MeshPhysicalMaterial({ color:0xff4d6d, metalness:.65, roughness:.2, clearcoat:.6, clearcoatRoughness:.25, emissive:0x330011, envMapIntensity:1 });
    const heart = new THREE.Mesh(extrude, mat);
    heart.rotation.x = Math.PI; heart.position.z = -1;
    scene.add(heart);

    // aura (bloom-like fake using sprite)
    const auraTex = new THREE.TextureLoader().load('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgcj0iNDAiIGZpbGw9InJnYmEoMjU1LCA3NywgMTA5LCAwLjI0KSIvPjwvc3ZnPg==');
    const auraMat = new THREE.SpriteMaterial({ map:auraTex, color:0xff4d6d, transparent:true, opacity:.6, depthWrite:false });
    const aura = new THREE.Sprite(auraMat); aura.scale.set(14,14,1); aura.position.z = -2; scene.add(aura);

    // particles
    const starsGeo = new THREE.BufferGeometry();
    const count = 400;
    const pos = new Float32Array(count*3);
    for (let i=0;i<count;i++){ pos[i*3+0]=(Math.random()-0.5)*20; pos[i*3+1]=(Math.random()-0.5)*12; pos[i*3+2]=(Math.random()-0.5)*10; }
    starsGeo.setAttribute('position', new THREE.BufferAttribute(pos,3));
    const starsMat = new THREE.PointsMaterial({ color:0xff8fab, size: .05, sizeAttenuation:true, transparent:true, opacity:.9 });
    const stars = new THREE.Points(starsGeo, starsMat); scene.add(stars);

    // parallax mouse
    let targetX=0, targetY=0; let mx=0,my=0;
    window.addEventListener('mousemove', (e)=>{ mx = (e.clientX/window.innerWidth - .5)*2; my = (e.clientY/window.innerHeight - .5)*2; });

    function tick(){
      requestAnimationFrame(tick);
      targetX += (mx - targetX)*0.05; targetY += (my - targetY)*0.05;
      heart.rotation.y += 0.005 + targetX*0.01; heart.rotation.z += 0.002;
      heart.position.y = Math.sin(performance.now()*0.0015)*0.25 + targetY*0.2;
      stars.rotation.y += 0.0008; stars.rotation.x += 0.0003;
      camera.position.x = targetX*0.6; camera.position.y = -targetY*0.6; camera.lookAt(0,0,-1);
      renderer.render(scene, camera);
    }
    tick();

    window.addEventListener('resize', ()=>{ renderer.setSize(window.innerWidth, window.innerHeight); camera.aspect = window.innerWidth/window.innerHeight; camera.updateProjectionMatrix(); });

    // ===================
    // GSAP Scroll reveals & parallax accents
    // ===================
    gsap.registerPlugin(ScrollTrigger);
    gsap.utils.toArray('section').forEach((sec)=>{
      gsap.fromTo(sec, {opacity:0, y:40}, {opacity:1, y:0, duration:1, ease:'power3.out', scrollTrigger:{trigger:sec, start:'top 80%'}})
    });
    gsap.to('.bg-blur', { yPercent: -10, ease:'none', scrollTrigger:{ trigger:'#home', start:'top top', end:'bottom top', scrub: true }});

    // ===================
    // Fancy hover tilt for photos
    // ===================
    const map = (n, a, b, c, d) => (n-a)*(d-c)/(b-a)+c;
    document.querySelectorAll('.ph').forEach(card=>{
      card.addEventListener('mousemove', (e)=>{
        const r = card.getBoundingClientRect();
        const rx = map(e.clientY, r.top, r.bottom, 8, -8);
        const ry = map(e.clientX, r.left, r.right, -10, 10);
        card.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
      });
      card.addEventListener('mouseleave', ()=>{ card.style.transform = 'rotateX(0) rotateY(0)'; });
    });

    // ===================
    // Audio Player + Visualizer (Web Audio API)
    // ===================
    const audio = document.getElementById('audio');
    const toggle = document.getElementById('toggle');
    const seek = document.getElementById('seek');
    const cur = document.getElementById('cur');
    const dur = document.getElementById('dur');
    const playSongCTA = document.getElementById('playSong');

    const fmt = (t)=>{ if(!isFinite(t)) return '0:00'; const m=Math.floor(t/60), s=Math.floor(t%60).toString().padStart(2,'0'); return `${m}:${s}` }
    function updateSeek(){ seek.value = audio.duration ? (audio.currentTime / audio.duration) * 100 : 0; cur.textContent = fmt(audio.currentTime); dur.textContent = fmt(audio.duration); }
    audio.addEventListener('timeupdate', updateSeek); audio.addEventListener('loadedmetadata', updateSeek);

    toggle.addEventListener('click', ()=>{ if(audio.paused){ audio.play(); toggle.textContent='Pause ‚è∏'; } else { audio.pause(); toggle.textContent='Play ‚èµ'; } });
    playSongCTA.addEventListener('click', ()=>{ audio.play(); toggle.textContent='Pause ‚è∏'; });
    seek.addEventListener('input', ()=>{ if (!audio.duration) return; audio.currentTime = (seek.value/100)*audio.duration; });
    document.getElementById('back10').addEventListener('click', ()=> audio.currentTime = Math.max(0, audio.currentTime - 10));
    document.getElementById('fwd10').addEventListener('click', ()=> audio.currentTime = Math.min(audio.duration||0, audio.currentTime + 10));

    // Visualizer
    const viz = document.getElementById('viz');
    const vctx = viz.getContext('2d');
    let actx, analyser, src;
    function initAudio(){
      if (actx) return;
      actx = new (window.AudioContext || window.webkitAudioContext)();
      analyser = actx.createAnalyser(); analyser.fftSize = 256; analyser.smoothingTimeConstant = .85;
      src = actx.createMediaElementSource(audio); src.connect(analyser); analyser.connect(actx.destination);
    }
    function drawViz(){
      requestAnimationFrame(drawViz);
      if(!analyser) return;
      const W = viz.width = viz.clientWidth; const H = viz.height = viz.clientHeight;
      const data = new Uint8Array(analyser.frequencyBinCount); analyser.getByteFrequencyData(data);
      vctx.clearRect(0,0,W,H);
      const barW = W / data.length;
      for(let i=0; i<data.length; i++){
        const v = data[i]/255; const h = v*H;
        vctx.fillStyle = `rgba(255, 77, 109, ${0.6 + v*0.4})`;
        vctx.fillRect(i*barW, H-h, barW*0.9, h);
      }
    }
    audio.addEventListener('play', ()=>{ initAudio(); drawViz(); if (actx && actx.state==='suspended') actx.resume(); });
  </script>
</body>
</html>
